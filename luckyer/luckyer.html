<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="target-densitydpi=device-dpi, width=device-width, initial-scale=1, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
<title>抽奖</title>


<link rel="stylesheet" href="css/demo.css" type="text/css">
<link rel="stylesheet" type="text/css" href="css/sweet-alert.css">
<link type="image/x-icon" rel="shortcut icon" href="favicon.ico" media="screen">

<link rel="stylesheet" type="text/css" href="css/ui.css" />
<link rel="stylesheet" type="text/css" href="css/m.base.css" />
<link type="image/x-icon" rel="shortcut icon" href="favicon.ico" media="screen">
<style type="text/css">
html,body { margin: 0; padding: 0; position: relative;  background-position: center; /*background-repeat: no-repeat;*/ width: 100%; height: 100%; background-size: 100% 100%; }
body
{
	padding-top: 136px;
    padding-left: 7%;
    padding-right: 7%;
    box-sizing: border-box;
}
</style>

<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/awardRotate.js"></script>
<script src="js/sweet-alert.min.js"></script>
</head>
<body id="body" style="background: url(img/chou.png) no-repeat;background-size:100% 100%;background-position:center center;height:100%;">
<div style="background:rgba(0,0,0,0);width:100%;height:100%;z-index:6666666;position:absolute;top:0;left:0;display:none;" class="hidebg"></div>

<div id="canvas" class="posiretive" style="height: 100%;">
	<!--<div class="turntable-bg" style="width: 100%;height: auto;overflow: hidden;">-->
	<div style="position:absolute;top:0;">
		<img src="img/bd.png" alt="turntable" style="z-index: 9;"/>
	</div>
	<div  class=" posiretive" style="z-index: 6;padding:3%;box-sizing:border-box;">
		<div class="pointer" id="pointer">
			<img src="img/btn-loaw.png" alt="pointer" style="position: absolute;top: 50%;left: 50%;margin-left: -12%;margin-top: -12%;z-index: 999;width:25%;"/>
		</div>

		<div class="rotate">
			<img id="rotate" src="img/raload.png" alt="turntable" style="z-index: 3;"/>
		</div>

		<div style="position:absolute;top:-14px;left:50%;margin-left:-9px;">
			<img src="img/d.png" alt="" style="width:35%;" />
		</div>
	</div>


	<div style="text-align:center;color:#fff;font-size:1.4rem;font-weight:bold;">
		<!-- <div style="width:60%;border:1px solid #fff;margin:0 auto;border-radius:10px;padding:6px 0;">剩余<span class="cnum" style="1.4rem"></span>抽奖机会</div> -->
		<div style="margin:10px auto 0;text-align:left;">① 每个用户每天可玩转2次更多优惠活动正在进行中</div>
		<div style="margin:0 auto;text-align:left;">② 优惠券/兑换码中奖请在会员中心查看</div>
		<div style="margin:0 auto;text-align:left;">③ 实物奖品中奖后将有专人联系发放</div>
		<div style="margin:0 auto;text-align:left;">*本活动最终解释权归咖啡蜗所有</div>
	</div>
</div>

    <script src="js/config.js" type="text/javascript" charset="utf-8"></script>
    <script src="js/jquery.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="js/m.ui.js" type="text/javascript" charset="utf-8"></script>
    <script src="js/m.base.js" type="text/javascript" charset="utf-8"></script>
    <script src="js/awardRotate.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript">
var infoGetMoney;
$(function (){
	$('.pointer').click(function(){
		$(".hidebg").show();
			var rotateTimeOut = function (){
				$('#rotate').rotate({
					angle:0,
					animateTo:2160,
					duration:8000,
					callback:function (){
						alert('网络超时，请检查您的网络设置！');
					}
				});
			};
			var bRotate = false;

			var rotateFn = function (awards, angles, txt){
				bRotate = !bRotate;
				$('#rotate').stopRotate();
				$('#rotate').rotate({
					angle:0,
					animateTo:angles+1800,
					duration:8000,
					callback:function (){
						if(txt == "谢谢惠顾"){
							swal({   title: "感谢您的参与",   imageUrl: "images/luckyfive.png" });
							$(".hidebg").hide();
						}else{
							swal({   title: "获得"+txt,   imageUrl: "images/gx.png" });
							$(".hidebg").hide();
						}
						bRotate = !bRotate;
					}
				})
			};
		(function(){
				if(bRotate)return;
				var item = raffle_init();
				switch (item) {
					case 0:
						//var angle = [137, 185, 235, 287];
						rotateFn(0, 240, '免单优惠券');
						infoGetMoney = 0;
						break;
					case 1:
						//var angle = [185, 235, 287];
						rotateFn(1, 180, '￥2.00优惠券');
						infoGetMoney = 1;
						break;
					case 2:
						//var angle = [26, 88, 137, 185, 235, 287, 337];
						rotateFn(2, 120, 'IPHONE X');
						infoGetMoney = 2;
						break;
					case 3:
						//var angle = [137, 185, 235, 287];
						rotateFn(3, 60, '￥5.00优惠券');
						infoGetMoney = 3;
						break;
					case 4:
						//var angle = [185, 235, 287];
						rotateFn(4, 360, '谢谢惠顾');
						infoGetMoney = 4;
						break;
					case 5:
						//var angle = [88, 137, 185, 235, 287];
						rotateFn(5, 300, 'IPAD PPO');
						infoGetMoney = 5;
						break;
				}

				console.log(item);
				return item;
		})();
	});
});

function rnd(n, m){
	return Math.floor(Math.random()*(m-n+1)+n)
}
var raffle_init = function()
{
	var _raff;
	var _init = JSON.parse(localStorage.getItem("token"));   //用户权限指令
	// if(!_init){alert("未登录");window.location.href = "http://www.cbcoffee.cn/sharedcoffee/index.html"};
	$.ajax({
		url: 'http://120.79.53.95/raffle_init',
		type: 'GET',
		dataType: 'json',
		async:false,
		data: {userId: _init.userid,userToken:_init.token,type:2}
		// data: {userId: 120,userToken:"91e70adf107fb24af0bce6c756607988",type:2}
	})
	.done(function(reg) {
		console.log(reg);
		if(reg.statusCode.status == 6666)
			{
				_raff = reg.content;
			}
		else
			{
				_raff = -1;
				alert(reg.statusCode.msg);
				$(".hidebg").hide();
			};
	});
	return _raff;
};
</script>
	</body>
</html>
